---
title: Crie um aplicativo da barra de ferramentas de desenvolvimento
description: Aprenda a criar um aplicativo da barra de ferramentas de desenvolvimento para seu site.
type: recipe
i18nReady: true
---
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import { FileTree } from '@astrojs/starlight/components';
import { Steps } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';

O Astro inclui uma [barra de ferramentas de desenvolvimento](/pt-br/guides/dev-toolbar/) que voc√™ pode usar para inspecionar seu site, verificar problemas de acessibilidade e desempenho e mais. Essa barra de ferramentas pode ser estendida com aplicativos personalizados.

## Crie um aplicativo de barra de ferramentas de desenvolvimento motivacional

Nesta receita, voc√™ aprender√° a criar um aplicativo da barra de ferramentas de desenvolvimento que o ajudar√° a se manter motivado enquanto trabalha no seu site. Esse aplicativo exibir√° uma mensagem motivacional sempre que voc√™ o ativar.

:::tip
Quer apenas come√ßar rapidamente? Inicie seu aplicativo criando um novo projeto Astro com o template `toolbar-app`.

<PackageManagerTabs>
  <Fragment slot="npm">
    ```shell
    npm create astro@latest -- --template toolbar-app
    ```
  </Fragment>
  <Fragment slot="pnpm">
    ```shell
    pnpm create astro -- --template toolbar-app
    ```
  </Fragment>
  <Fragment slot="yarn">
    ```shell
    yarn create astro -- --template toolbar-app
    ```
  </Fragment>
</PackageManagerTabs>

Ou continue lendo para saber como criar um aplicativo do zero.
:::

### Criando a integra√ß√£o do Astro

Os aplicativos da barra de ferramentas de desenvolvimento s√≥ podem ser adicionados pelas [Integra√ß√µes do Astro](/pt-br/guides/integrations-guide/) usando o [hook `astro:config:setup`](/pt-br/reference/integrations-reference/#astroconfigsetup). Voc√™ precisar√° criar um aplicativo de barra de ferramentas e a integra√ß√£o que o adicionar√° √† barra de ferramentas do seu projeto Astro existente.

<Steps>
1. Na raiz do seu projeto Astro existente, crie uma nova pasta chamada `meu-app-toolbar/` para o aplicativo e os arquivos de integra√ß√£o. Crie dois novos arquivos nessa pasta: `app.ts` e `minha-integracao.ts`.

    <FileTree>
    - **meu-app-toolbar/**
      - **app.ts**
      - **minha-integracao.ts**
    - src/
      - pages/
      - ...
    - astro.config.mjs
    - package.json
    - tsconfig.json
    </FileTree>

2. Em `minha-integracao.ts`, adicione o seguinte c√≥digo para fornecer o nome da sua integra√ß√£o e a [fun√ß√£o `addDevToolbarApp()`](/pt-br/reference/dev-toolbar-app-reference/#toolbar-app-integration-setup) necess√°ria para adicionar o aplicativo da barra de ferramentas de desenvolvimento com o hook `astro:config:setup`:

    ```ts title="meu-app-toolbar/minha-integracao.ts" "'astro:config:setup'" "hooks" "addDevToolbarApp"
    import { fileURLToPath } from 'node:url';
    import type { AstroIntegration } from 'astro';

    export default {
      name: 'minha-integracao-astro',
      hooks: {
        'astro:config:setup': ({ addDevToolbarApp }) => {  
          addDevToolbarApp({
            id: "meu-app-toolbar",
            name: "Meu App da Toolbar",
            icon: "üöÄ",
            entrypoint: fileURLToPath(new URL('./app.ts', import.meta.url))
          });
        },
      },
    } satisfies AstroIntegration;
    ```
    :::note[Usando caminhos relativos para o ponto de entrada]
    O `entrypoint` √© o caminho para o arquivo do aplicativo da barra de ferramentas de desenvolvimento **relativo √† raiz do seu projeto Astro existente**, n√£o √† pasta de integra√ß√£o (`meu-app-toolbar`) em si.

    Para usar caminhos relativos para pontos de entrada, obtenha o caminho para o arquivo atual usando `import.meta.url` e resolva o caminho para o ponto de entrada a partir da√≠.
    :::

3. Para usar essa integra√ß√£o em seu projeto, adicione-a ao array `integrations` em seu arquivo `astro.config.mjs`.

    ```js title="astro.config.mjs" ins={2,5}
    import { defineConfig } from 'astro/config';
    import minhaIntegracao from './meu-app-toolbar/minha-integracao.ts';

    export default defineConfig({
      integrations: [minhaIntegracao],
    })
    ```

4. Se ainda n√£o estiver em execu√ß√£o, inicie o servidor de desenvolvimento. Se a sua integra√ß√£o tiver sido adicionada com √™xito ao projeto, voc√™ ver√° um novo aplicativo ‚Äúundefined‚Äù na barra de ferramentas de desenvolvimento.

    Por√©m, voc√™ tamb√©m ver√° uma mensagem de erro informando que o aplicativo da barra de ferramentas de desenvolvimento n√£o foi carregado. Isso ocorre porque voc√™ ainda n√£o criou o aplicativo propriamente dito. Voc√™ far√° isso na pr√≥xima se√ß√£o.
</Steps>

<ReadMore>Consulte a [documenta√ß√£o da API de Integra√ß√£o Astro](/pt-br/reference/integrations-reference/) para saber mais sobre como criar integra√ß√µes do Astro.</ReadMore>

### Criando o aplicativo

Os aplicativos da barra de ferramentas de desenvolvimento s√£o definidos usando a fun√ß√£o `defineToolbarApp()` do m√≥dulo `astro/toolbar`. Essa fun√ß√£o recebe um objeto com uma fun√ß√£o `init()` que ser√° chamada quando o aplicativo da barra de ferramentas de desenvolvimento for carregado.

Essa fun√ß√£o `init()` cont√©m a l√≥gica do seu aplicativo para renderizar elementos na tela, enviar e receber eventos do lado do cliente da barra de ferramentas de desenvolvimento e se comunicar com o servidor.

```ts title="app.ts"
import { defineToolbarApp } from "astro/toolbar";

export default defineToolbarApp({
    init(canvas, app, server) {
      // ...
    },
});
```

Para exibir mensagens motivacionais na tela, voc√™ usar√° a propriedade `canvas` para acessar um [ShadowRoot](https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot) padr√£o. Os elementos podem ser criados e adicionados ao ShadowRoot usando as APIs padr√£o do DOM.

<Steps>
1. Copie o c√≥digo a seguir em `meu-app-toolbar/app.ts`. Isso fornece uma lista de mensagens motivacionais e a l√≥gica para criar um novo elemento `<h1>` com uma mensagem aleat√≥ria:

    ```ts title="meu-app-toolbar/app.ts" {3-8, 12-15}
    import { defineToolbarApp } from "astro/toolbar";

    const mensagensMotivacionais = [
      "Voc√™ est√° indo muito bem!",
      "Continue com o bom trabalho!",
      "Voc√™ √© incr√≠vel!",
      "Voc√™ √© uma estrela!",
    ];

    export default defineToolbarApp({
        init(canvas) {
          const h1 = document.createElement('h1');
          h1.textContent = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];

          canvas.append(h1);
        },
    });
    ```

2. Inicie o servidor de desenvolvimento se ele ainda n√£o estiver em execu√ß√£o e ative o aplicativo na barra de ferramentas de desenvolvimento. Se o aplicativo estiver funcionando corretamente, voc√™ ver√° uma mensagem motivacional exibida no canto superior esquerdo da tela. (E √© verdade!) 

    No entanto, essa mensagem n√£o ser√° alterada quando o aplicativo for ativado e desativado, pois a fun√ß√£o `init()` √© chamada apenas uma vez quando o aplicativo √© carregado.

3. Para adicionar interatividade no lado do cliente ao seu aplicativo, adicione o argumento `app` e use `onAppToggled()` para selecionar uma nova mensagem aleat√≥ria sempre que o aplicativo da barra de ferramentas for ativado:

    ```ts title="app.ts" ins=", app" ins={17-21}
    import { defineToolbarApp } from "astro/toolbar";

    const mensagensMotivacionais = [
      "Voc√™ est√° indo muito bem!",
      "Continue com o bom trabalho!",
      "Voc√™ √© incr√≠vel!",
      "Voc√™ √© uma estrela!",
    ];

    export default defineToolbarApp({
        init(canvas, app) {
          const h1 = document.createElement('h1');
          h1.textContent = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
          
          canvas.append(h1);

          // Exibe uma mensagem aleat√≥ria quando o aplicativo for acionado
          app.onToggled(({ state }) => {
            const novaMensagem = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
            h1.textContent = novaMensagem;
          });
        },
    });
    ```

4. Na visualiza√ß√£o do navegador, ative e desative o aplicativo v√°rias vezes. Com essa altera√ß√£o, uma nova mensagem aleat√≥ria ser√° selecionada toda vez que voc√™ ativar o aplicativo, proporcionando uma fonte infinita de motiva√ß√£o!
</Steps>

<ReadMore>Consulte a [documenta√ß√£o da API da Barra de Ferramentas de Desenvolvimento do Astro](/pt-br/reference/dev-toolbar-app-reference/) para obter mais informa√ß√µes sobre a cria√ß√£o de aplicativos da barra de ferramentas de desenvolvimento.</ReadMore>

## Criando aplicativos com um framework de UI

Frameworks de interface do usu√°rio, como React, Vue ou Svelte, tamb√©m podem ser usados para criar aplicativos de barra de ferramentas de desenvolvimento. Esses frameworks oferecem uma maneira mais declarativa de criar UIs e podem tornar seu c√≥digo mais f√°cil de manter e ler.

O mesmo aplicativo de barra de ferramentas de desenvolvimento motivacional criado em seu projeto Astro existente anteriormente nesta p√°gina com JavaScript pode ser criado usando um framework de UI (por exemplo, Preact). Dependendo da estrutura escolhida, voc√™ pode ou n√£o precisar de uma etapa de build.

:::note 
Independentemente da sua escolha de criar o aplicativo da barra de ferramentas de desenvolvimento, usando JavaScript ou um framework de UI, voc√™ ainda precisar√° [criar a integra√ß√£o](#criando-a-integra√ß√£o-do-astro) que adiciona seu aplicativo √† barra de ferramentas de desenvolvimento.
:::

### Sem uma etapa de build

Se o seu framework permitir, voc√™ poder√° criar um aplicativo de barra de ferramentas de desenvolvimento sem uma etapa de build. Por exemplo, voc√™ pode usar a fun√ß√£o `h` do Preact para criar elementos e renderiz√°-los diretamente no ShadowRoot:

```ts title="app.ts"
import { defineToolbarApp } from "astro/toolbar";
import { render, h } from "preact";

const mensagensMotivacionais = [
  "Voc√™ est√° indo muito bem!",
  "Continue com o bom trabalho!",
  "Voc√™ √© incr√≠vel!",
  "Voc√™ √© uma estrela!",
];

export default defineToolbarApp({
    init(canvas) {
      const mensagem = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
      render(h('h1', null, mensagem), canvas);
    },
});
```

Como alternativa, o [pacote `htm`](https://github.com/developit/htm) √© uma boa op√ß√£o para criar aplicativos da barra de ferramentas de desenvolvimento sem uma etapa de build, oferecendo integra√ß√£o nativa para React e Preact e suporte para outros frameworks:

```ts title="app.ts" ins={3, 15}
import { defineToolbarApp } from "astro/toolbar";
import { render } from "preact";
import { html } from 'htm/preact';

const mensagensMotivacionais = [
  "Voc√™ est√° indo muito bem!",
  "Continue com o bom trabalho!",
  "Voc√™ √© incr√≠vel!",
  "Voc√™ √© uma estrela!",
];

export default defineToolbarApp({
    init(canvas) {
      const mensagem = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
      render(html`<h1>${mensagem}</h1>`, canvas);
    },
});
```

Em ambos os casos, agora voc√™ pode iniciar seu projeto e ver a mensagem motivacional exibida no canto superior esquerdo da tela ao ativar o aplicativo.

### Com uma etapa de build

O Astro n√£o pr√©-processa o c√≥digo JSX em aplicativos da barra de ferramentas de desenvolvimento, portanto, √© necess√°ria uma etapa de build para usar componentes JSX em seu aplicativo da barra de ferramentas de desenvolvimento.

As etapas a seguir usar√£o o TypeScript para fazer isso, mas qualquer outra ferramenta que compile c√≥digo JSX tamb√©m funcionar√° (por exemplo, Babel, Rollup e ESBuild).

<Steps>
1. Instale o TypeScript em seu projeto:

    <PackageManagerTabs>
      <Fragment slot="npm">
        ```shell
        npm install --save-dev typescript
        ```
      </Fragment>
      <Fragment slot="pnpm">
        ```shell
        pnpm install --save-dev typescript
        ```
      </Fragment>
      <Fragment slot="yarn">
        ```shell
        yarn add --dev typescript
        ```
      </Fragment>
    </PackageManagerTabs>

2. Crie um arquivo `tsconfig.json` na raiz da pasta do seu aplicativo de barra de ferramentas com as configura√ß√µes apropriadas para o build e para o framework que voc√™ est√° usando ([React](https://react-typescript-cheatsheet.netlify.app/docs/basic/setup), [Preact](https://preactjs.com/guide/v10/typescript) e [Solid](https://www.solidjs.com/guides/typescript)). Por exemplo, para o Preact:

    ```json title="meu-app-toolbar/tsconfig.json"
    {
      "compilerOptions": {
        "skipLibCheck": true,
        "module": "NodeNext",
        "jsx": "react-jsx",
        "jsxImportSource": "preact",
      }
    }
    ```

3. Ajuste o `entrypoint` em sua integra√ß√£o para apontar para o arquivo compilado, lembrando que esse arquivo √© relativo √† raiz do seu projeto Astro:

    ```ts title="minha-integracao.ts" ins="app.js"
    addDevToolbarApp({
      id: "meu-app-toolbar",
      name: "Meu App da Toolbar",
      icon: "üöÄ",
      entrypoint: join(__dirname, "./app.js"),
    });
    ```

4. Execute `tsc` para criar o aplicativo da barra de ferramentas ou `tsc --watch` para automaticamente fazer o build do aplicativo quando voc√™ fizer altera√ß√µes.

    Com essas mudan√ßas, agora voc√™ pode renomear seu arquivo `app.ts` para `app.tsx` (ou `.jsx`) e usar a sintaxe JSX para criar seu aplicativo da barra de ferramentas de desenvolvimento:

    ```tsx title="app.tsx"
    import { defineToolbarApp } from "astro/toolbar";
    import { render } from "preact";

    const mensagensMotivacionais = [
      "Voc√™ est√° indo muito bem!",
      "Continue com o bom trabalho!",
      "Voc√™ √© incr√≠vel!",
      "Voc√™ √© uma estrela!",
    ];

    export default defineToolbarApp({
        init(canvas) {
          const mensagem = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
          render(<h1>{mensagem}</h1>, canvas);
        },
    });
    ```
</Steps>

Agora voc√™ deve ter todas as ferramentas necess√°rias para criar um aplicativo de barra de ferramentas de desenvolvimento usando um framework de UI de sua escolha!
